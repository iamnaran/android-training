package com.nepal.andoriddemo.fcm;import android.annotation.SuppressLint;import android.app.NotificationChannel;import android.app.NotificationManager;import android.app.PendingIntent;import android.content.Context;import android.content.Intent;import android.graphics.Color;import android.media.AudioAttributes;import android.media.RingtoneManager;import android.net.Uri;import android.os.Build;import android.util.Log;import androidx.annotation.NonNull;import androidx.core.app.NotificationCompat;import com.google.firebase.messaging.FirebaseMessagingService;import com.google.firebase.messaging.RemoteMessage;import com.google.gson.GsonBuilder;import com.nepal.andoriddemo.R;import com.nepal.andoriddemo.activities.NotificationActivity;import com.nepal.andoriddemo.utils.Utilities;public class UpasargaFirebaseMessagingService extends FirebaseMessagingService {    @Override    public void onMessageReceived(@NonNull RemoteMessage remoteMessage) {        super.onMessageReceived(remoteMessage);        Log.e( "onMessageReceived: ", new GsonBuilder().create().toJson(remoteMessage.getData()));        sendNotification("From FCM", "Hello");    }    @Override    public void onNewToken(@NonNull String token) {        super.onNewToken(token);        // generates new token        Log.e("onNewToken: ", token);        Utilities.saveFcmToken(token);    }    private void sendNotification(String title, String message) {        Intent intent = new Intent(getApplicationContext(), NotificationActivity.class);        intent.setFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP | Intent.FLAG_ACTIVITY_SINGLE_TOP | Intent.FLAG_ACTIVITY_CLEAR_TASK | Intent.FLAG_ACTIVITY_NEW_TASK);        PendingIntent pendingIntent = PendingIntent.getActivity(getApplicationContext(), 0 /* Request code */, intent,                PendingIntent.FLAG_ONE_SHOT);        String channelId = getString(R.string.default_notification_channel_id);        Uri defaultSoundUri = RingtoneManager.getDefaultUri(RingtoneManager.TYPE_NOTIFICATION);        NotificationCompat.Builder notificationBuilder =                new NotificationCompat.Builder(getApplicationContext(), channelId)                        .setSmallIcon(R.drawable.ic_push_notification)                        .setContentTitle(title)                        .setContentText(message)                        .setAutoCancel(true)                        .setSound(defaultSoundUri)                        .setContentIntent(pendingIntent);        NotificationManager notificationManager =                (NotificationManager) getSystemService(Context.NOTIFICATION_SERVICE);        if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.O) {            createNotificationChannel(channelId, notificationManager);        }        assert notificationManager != null;        notificationManager.notify((int) System.currentTimeMillis(), notificationBuilder.build());    }    @SuppressLint("NewApi")    public void createNotificationChannel(String channelId, NotificationManager notificationManager) {        @SuppressLint("WrongConstant")        NotificationChannel channel = new NotificationChannel(channelId, getString(R.string.app_name),                NotificationManager.IMPORTANCE_MAX);        AudioAttributes att = new AudioAttributes.Builder()                .setUsage(AudioAttributes.USAGE_NOTIFICATION)                .setContentType(AudioAttributes.CONTENT_TYPE_SPEECH)                .build();        assert notificationManager != null;        channel.setLightColor(Color.parseColor("#F1E605"));        channel.canShowBadge();        channel.enableVibration(true);        notificationManager = (NotificationManager) getSystemService(Context.NOTIFICATION_SERVICE);        notificationManager.createNotificationChannel(channel);    }}